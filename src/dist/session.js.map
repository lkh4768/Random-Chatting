{"version":3,"sources":["../es6/session.js"],"names":["Session","socket","_id","SEQ","_socket","_init","on","had_error","_close","call","error","_error","buf","_data","_drain","_end","_timeout","text","callback","console","log","write","ENCODING","module","exports"],"mappings":";;;;;;IAAMA,O;AACJ,mBAAYC,MAAZ,EAAmB;AAAA;;AACjB,SAAKC,GAAL,GAAWF,QAAQG,GAAR,EAAX;AACA,SAAKC,OAAL,GAAeH,MAAf;AACA,SAAKI,KAAL;AACD;;;;4BACM;AAAA;;AACL,WAAKD,OAAL,CAAaE,EAAb,CAAgB,OAAhB,EAAyB,UAACC,SAAD,EAAe;AAAC,cAAKC,MAAL,CAAYC,IAAZ,CAAiBF,SAAjB;AAA6B,OAAtE;AACA,WAAKH,OAAL,CAAaE,EAAb,CAAgB,OAAhB,EAAyB,UAACI,KAAD,EAAW;AAAC,cAAKC,MAAL,CAAYD,KAAZ;AAAoB,OAAzD;AACA,WAAKN,OAAL,CAAaE,EAAb,CAAgB,MAAhB,EAAwB,UAACM,GAAD,EAAO;AAAC,cAAKC,KAAL,CAAWD,GAAX;AAAiB,OAAjD;AACA,WAAKR,OAAL,CAAaE,EAAb,CAAgB,OAAhB,EAAyB,KAAKQ,MAA9B;AACA,WAAKV,OAAL,CAAaE,EAAb,CAAgB,KAAhB,EAAuB,KAAKS,IAA5B;AACA,WAAKX,OAAL,CAAaE,EAAb,CAAgB,SAAhB,EAA2B,KAAKU,QAAhC;AACD;;;4BACM;AACL,aAAO,KAAKd,GAAZ;AACD;;;yBACIe,I,EAAMC,Q,EAAS;AAAA;;AAClB,UAAG,CAACA,QAAJ,EAAcA,WAAW,oBAAI;AAAEC,gBAAQC,GAAR,kBAA2BH,IAA3B,qBAA+C,OAAKf,GAApD;AAA6D,OAA9E;AACd,WAAKE,OAAL,CAAaiB,KAAb,CAAmBJ,IAAnB,EAAyBjB,QAAQsB,QAAjC,EAA2CJ,QAA3C;AACD;;;2BACMX,S,EAAU;AACfY,cAAQC,GAAR,oBAA6B,KAAKlB,GAAlC,qBAAqDK,SAArD;AACD;;;2BACMG,K,EAAM;AACXS,cAAQC,GAAR,YAAqBV,KAArB,kBAAuC,KAAKR,GAA5C;AACD;;;0BACKU,G,EAAI;AACRO,cAAQC,GAAR,WAAoBR,GAApB,kBAAoC,KAAKV,GAAzC;AACD;;;6BACO;AACNiB,cAAQC,GAAR,oBAA6B,KAAKlB,GAAlC;AACD;;;2BACK;AACJiB,cAAQC,GAAR,kBAA2B,KAAKlB,GAAhC;AACD;;;+BACS;AACRiB,cAAQC,GAAR,sBAA+B,KAAKlB,GAApC;AACD;;;;;;AAEHF,QAAQsB,QAAR,GAAmB,MAAnB;AACAtB,QAAQG,GAAR,GAAc,CAAd;AACAoB,OAAOC,OAAP,GAAiBxB,OAAjB","file":"session.js","sourcesContent":["class Session{\r\n  constructor(socket){\r\n    this._id = Session.SEQ++;\r\n    this._socket = socket;\r\n    this._init();\r\n  }\r\n  _init(){\r\n    this._socket.on('close', (had_error) => {this._close.call(had_error);});\r\n    this._socket.on('error', (error) => {this._error(error);});\r\n    this._socket.on('data', (buf)=>{this._data(buf);});\r\n    this._socket.on('drain', this._drain);\r\n    this._socket.on('end', this._end);\r\n    this._socket.on('timeout', this._timeout);\r\n  }\r\n  getId(){\r\n    return this._id;\r\n  }\r\n  send(text, callback){\r\n    if(!callback) callback = ()=>{ console.log(`sended text(${text}) to session(${this._id})`);};\r\n    this._socket.write(text, Session.ENCODING, callback);\r\n  }\r\n  _close(had_error){\r\n    console.log(`close session(${this._id}), had error(${had_error})`);\r\n  }\r\n  _error(error){\r\n    console.log(`error(${error}) session(${this._id})`);\r\n  }\r\n  _data(buf){\r\n    console.log(`data(${buf}) session(${this._id})`);\r\n  }\r\n  _drain(){\r\n    console.log(`drain session(${this._id})`);\r\n  }\r\n  _end(){\r\n    console.log(`end session(${this._id})`);\r\n  }\r\n  _timeout(){\r\n    console.log(`timeout session(${this._id})`);\r\n  }\r\n}\r\nSession.ENCODING = 'utf8';\r\nSession.SEQ = 0;\r\nmodule.exports = Session;\r\n"]}