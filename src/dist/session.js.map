{"version":3,"sources":["../es6/session.js"],"names":["Session","socket","events","_id","SEQ","_socket","setEvent","console","log","eventNameKey","EVENT_NAMES","on","data","DEFAULT_EVENT","destroyed","destroy","CLOSE","ERROR","DATA","DRAIN","END","TIMEOUT","id","had_error","error","buf","module","exports"],"mappings":"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","file":"session.js","sourcesContent":["class Session{\r\n  constructor(socket, events){\r\n    this._id = Session.SEQ++;\r\n    this._socket = socket;\r\n    this.setEvent(events);\r\n  }\r\n  setEvent(events){\r\n    console.log(events);\r\n    if(events) {\r\n      for (let eventNameKey in Session.EVENT_NAMES) {\r\n        if (Session.EVENT_NAMES[eventNameKey] === 'close' || Session.EVENT_NAMES[eventNameKey] === 'error' || Session.EVENT_NAMES[eventNameKey] === 'data') {\r\n          if (events[Session.EVENT_NAMES[eventNameKey]]) this._socket.on(Session.EVENT_NAMES[eventNameKey], (data) => {events[Session.EVENT_NAMES[eventNameKey]](this._id, data);});\r\n          else this._socket.on(Session.EVENT_NAMES[eventNameKey], (data) => {Session.DEFAULT_EVENT[eventNameKey](this._id, data);});\r\n        } else {\r\n          if (events[Session.EVENT_NAMES[eventNameKey]]) this._socket.on(Session.EVENT_NAMES[eventNameKey], () => {events[Session.EVENT_NAMES[eventNameKey]](this._id);});\r\n          else this._socket.on(Session.EVENT_NAMES[eventNameKey], () => {Session.DEFAULT_EVENT[eventNameKey](this._id);});\r\n        }\r\n      }\r\n    }\r\n  }\r\n  getId(){\r\n    return this._id;\r\n  }\r\n  getSocket(){\r\n    return this._socket;\r\n  }\r\n\tclose(){\r\n\t\tif(!this._socket.destroyed) this._socket.destroy();\r\n\t}\r\n}\r\n\r\nSession.SEQ = 1;\r\nSession.EVENT_NAMES = { CLOSE: 'close', ERROR: 'error', DATA: 'data', DRAIN: 'drain', END: 'end', TIMEOUT: 'timeout' };\r\nSession.DEFAULT_EVENT = {\r\n  CLOSE: (id, had_error)=>{ console.log(`close session(${id}), had error(${had_error})`); },\r\n  ERROR: (id, error)=>{ console.log(`error(${error}) session(${id})`); },\r\n  DATA: (id, buf)=>{ console.log(`data(${buf}) session(${id})`); },\r\n  DRAIN: (id)=>{ console.log(`drain session(${id})`); },\r\n  END: (id)=> {console.log(`end session(${id})`); },\r\n  TIMEOUT: (id)=>{ console.log(`timeout session(${id})`); }\r\n};\r\nmodule.exports = Session;\r\n"]}